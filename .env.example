# ==========================================
# Database Configuration (REQUIRED)
# ==========================================
# Connection string for PostgreSQL.
# Format: postgres://user:password@host:port/database_name
DATABASE_URL=postgres://postgres:postgres@localhost:5432/compliance_relayer

# ==========================================
# Blockchain Configuration
# ==========================================
# The RPC Endpoint.
# - Production: Use Helius, QuickNode, Alchemy (e.g., https://mainnet.helius-rpc.com/?api-key=...)
# - Development: https://api.devnet.solana.com
SOLANA_RPC_URL=https://api.devnet.solana.com

# Base58 private key of the wallet that will pay for transactions.
# WARNING: Do NOT use a wallet with significant funds in dev/test environments.
# If left empty or invalid, the app generates a random ephemeral key (funds will be lost on restart).
ISSUER_PRIVATE_KEY=YOUR_BASE58_ENCODED_PRIVATE_KEY_HERE

# ==========================================
# Compliance Configuration (Range Protocol)
# ==========================================
# API Key for Range Protocol (Risk/Sanctions screening).
# - If SET: Real compliance checks are performed via Range API.
# - If EMPTY or MISSING: App runs in MOCK MODE (accepts all, blocks specific test addresses).
RANGE_API_KEY=

# Optional: Override Range API URL (default is https://api.range.org/v1)
# Leave commented unless you have a specific enterprise endpoint.
# RANGE_API_URL=https://api.range.org/v1

# Risk score threshold for rejecting addresses (1-10, default: 6)
# Range API risk scores: 1=Very Low, 2-3=Low, 4-5=Medium, 6-7=High, 8-9=Extremely High, 10=Critical
# Addresses with risk_score >= this threshold will be REJECTED.
# Examples:
#   6 (default) = Reject High risk and above
#   8 = Reject only Extremely High and Critical
#   2 = Very strict - reject almost everything
# RANGE_RISK_THRESHOLD=6

# ==========================================
# Server Configuration
# ==========================================
# Interface to bind to. 0.0.0.0 allows external access (docker), 127.0.0.1 is local only.
HOST=0.0.0.0
PORT=3000

# ==========================================
# Rate Limiting (DoS Protection)
# ==========================================
# Enable Governor rate limiting middleware? (true/false)
ENABLE_RATE_LIMITING=true

# Requests Per Second allowed per IP (approximate)
RATE_LIMIT_RPS=10

# Burst size (how many requests can be sent at once before throttling)
RATE_LIMIT_BURST=20

# ==========================================
# Background Worker
# ==========================================
# Enables the process that retries failed blockchain submissions.
# Recommended: true for production/staging.
ENABLE_BACKGROUND_WORKER=true

# ==========================================
# Observability
# ==========================================
# Logging levels.
# standard: info
# verbose: debug
# quiet sql: sqlx=warn (prevents logging every single SQL query)
RUST_LOG=info,tower_http=debug,sqlx=warn

# ==========================================
# Jito Bundle Configuration (MEV Protection)
# ==========================================
# Enable Jito bundle submission for MEV-protected transactions.
# When enabled, transactions are submitted privately via Jito block builders,
# bypassing the public mempool. This prevents frontrunning and sandwich attacks.
#
# REQUIREMENTS:
#   - QuickNode RPC endpoint with "Lil' JIT - JITO Bundles" add-on enabled
#   - USE_JITO_BUNDLES=true
#
# BEHAVIOR:
#   - Transactions are submitted via Jito bundles (private mempool)
#   - A tip instruction is automatically appended to each transaction
#   - Returns immediately after bundle acceptance (async confirmation)
#   - If Jito submission fails, transaction is NOT sent to public mempool (fail-safe)
#
# DEFAULT: false (explicit opt-in required for MEV protection)
USE_JITO_BUNDLES=false

# Jito tip amount in lamports (paid to block builders for priority inclusion)
# This tip is automatically added as a SOL transfer to a Jito tip account.
#
# IMPORTANT: Tips are REQUIRED for Jito bundle acceptance!
#   - Minimum: 1000 lamports (0.000001 SOL)
#   - Recommended: 10000-50000 lamports during normal traffic
#   - High congestion: 100000+ lamports may be needed
#
# Default: 10000 lamports = 0.00001 SOL
JITO_TIP_LAMPORTS=10000

# Optional: Jito region for lower latency
# Valid values: ny, amsterdam, frankfurt, tokyo
# Leave empty/unset to let Jito auto-select optimal region
# JITO_REGION=ny

# ==========================================
# Webhook Configuration (Transaction Confirmation)
# ==========================================
# Helius webhook secret for validating incoming webhooks.
# Create a webhook at https://dev.helius.xyz/webhooks and set the secret here.
# If not set, webhook authentication is disabled (not recommended for production).
# HELIUS_WEBHOOK_SECRET=your-helius-webhook-secret

# QuickNode webhook secret for validating incoming webhooks.
# Create a Stream/Webhook at https://dashboard.quicknode.com/streams and configure:
# - Template: "Solana Transaction" or custom filter for your wallet
# - Destination: https://your-relayer-host/webhooks/quicknode
# - Set a secret token for authentication
# If not set, webhook authentication is disabled (not recommended for production).
# QUICKNODE_WEBHOOK_SECRET=your-quicknode-webhook-secret

# ==========================================
# CORS Configuration
# ==========================================
# Comma-separated list of allowed origins for CORS.
# Default: https://solana-compliance-relayer-frontend.berektassuly.com
# localhost:3000 and localhost:3001 are always allowed for development.
CORS_ALLOWED_ORIGINS=https://solana-compliance-relayer-frontend.berektassuly.com